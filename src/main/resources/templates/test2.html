<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <!-- Meta tags and title for the page -->
  <meta charset="UTF-8">
  <title>Log Workout - VFC</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap CSS for styling -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <style>
    /* Left Sidebar Styling */
    .sidebar {
        height: 100vh;
        background-color: #2c3e50; /* Dark color from original second HTML */
        color: white;
        position: sticky;
        top: 0;
        overflow-y: auto;
    }
    .sidebar .nav-link {
        color: white; /* White text for dark background */
    }
    .sidebar .nav-link:hover {
        color: #3498db; /* Blue hover color from original */
    }
    .sidebar .nav-link.active {
        color: #3498db; /* Blue active color */
        font-weight: bold;
    }
    .post {
        border: 1px solid #ddd;
        border-radius: 5px;
        margin-bottom: 15px;
    }
    .progress {
        background-color: #e9ecef;
    }
    .progress-bar-custom {
        background-color: #2ecc71; /* Keep the green progress bar */
    }
    .challenge, .tribe {
        background-color: #ffffff;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
        margin-bottom: 15px;
        color: #212529;
    }
    /* Right Sidebar Styling */
    .right-sidebar {
        position: sticky;
        top: 0;
        overflow-y: auto;
        height: 100vh;
        color: #212529;
        background-color: #f8f9fa;
    }
    /* Hide sidebars on small screens */
    @media (max-width: 767.98px) {
        .sidebar, .right-sidebar {
            display: none;
        }
    }
    /* Adjust main content padding */
    .main-content {
        padding: 20px;
    }
    /* Custom Navbar Styling */
  .navbar-custom {
      background-color: #2c3e50; /* Match sidebar color */
  }
  .navbar-custom .navbar-nav .nav-link {
      color: white; /* White text for dark background */
  }
  .navbar-custom .navbar-nav .nav-link:hover {
      color: #3498db; /* Blue hover color */
  }
  .navbar-custom .navbar-nav .nav-link.active {
      color: #3498db; /* Blue active color */
      font-weight: bold;
  }
  .navbar-custom .navbar-brand img {
      filter: brightness(0) invert(1); /* Invert logo to white for visibility on dark background */
  }

  </style>
</head>
<body class="bg-light text-dark">
<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-dark navbar-custom">
<!--<nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom border-secondary">-->
  <div class="container">
    <!-- Logo and Brand -->
    <a class="navbar-brand" href="/dashboard">
      <img src="/assets/images/logo.png" alt="VFC Logo" height="30">
    </a>
    <!-- Mobile Toggle Button -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <!-- Navigation Links -->
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto">
        <li class="nav-item">
          <a class="nav-link" th:href="@{/users/dashboard}"><i class="bi bi-house-door"></i> Dashboard</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" th:href="@{/posts/add-post}"><i class="bi bi-house-door"></i> Post Message</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" th:href="@{/workouts/addWorkout(userId=${user.userId})}"><i class="bi bi-plus-circle"></i> Log Workout</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" th:href="@{/meals/addMeal(userId=${user.userId})}"><i class="bi bi-cup-hot"></i> Log Meal</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/challenges"><i class="bi bi-trophy"></i> Challenges</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/leaderboard"><i class="bi bi-bar-chart"></i> Leaderboard</a>
        </li>
      </ul>
      <!-- User Menu -->
      <div class="navbar-nav">
        <div class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
            <i class="bi bi-person-circle"></i> <span th:text="${user.userName}">User</span>
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="/profile"><i class="bi bi-person"></i> Profile</a></li>
            <li><a class="dropdown-item" href="/settings"><i class="bi bi-gear"></i> Settings</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="/logout"><i class="bi bi-box-arrow-right"></i> Logout</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</nav>

<!-- Main Layout with Sidebar -->
<div class="container-fluid">
  <div class="row">
    <!-- Left Sidebar (visible on medium and larger screens) -->
    <nav class="col-md-2 d-none d-md-block sidebar p-3">
      <ul class="nav flex-column">
        <li class="nav-item">
          <a class="nav-link" th:href="@{/posts/listFeed}"><i class="bi bi-house-door"></i> My Newsfeed</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" th:href="@{/posts/listPosts}"><i class="bi bi-file-post"></i> My Posts</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" th:href="@{/meals/listMeals}"><i class="bi bi-cup-hot"></i> My Meals</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" th:href="@{/workouts/listWorkouts}"><i class="bi bi-plus-circle"></i> My Workouts</a>
        </li>


        <li class="nav-item">
          <a class="nav-link" th:href="@{/users/friends/{id}(id=${session.user.userId})}"><i class="bi bi-person-plus"></i> My Friends</a>
        </li>
        <!--
        <li class="nav-item">
          <a class="nav-link" th:href="@{#}"><i class="bi bi-chat"></i> Chats</a>
        </li>-->
      </ul>
    </nav>

    <!-- Main Content -->
    <main class="col-md-7 main-content">
      <!-- Page Header -->
      <div class="row mb-4">
        <div class="col">
          <h2>Template</h2>
          <p class="text-muted">Describe this page.</p>
        </div>
      </div>

      <div class="container">
        <h2>Welcome, <span th:text="${userName}"></span></h2>

        <!-- Tabs -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="posts-tab" data-bs-toggle="tab" data-bs-target="#posts" type="button" role="tab" aria-controls="posts" aria-selected="false">Posts</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="workouts-tab" data-bs-toggle="tab" data-bs-target="#workouts" type="button" role="tab" aria-controls="workouts" aria-selected="true">Workouts</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="meals-tab" data-bs-toggle="tab" data-bs-target="#meals" type="button" role="tab" aria-controls="meals" aria-selected="false">Meals</button>
          </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="myTabContent">
          <!-- Workouts Tab -->
          <div class="tab-pane fade show active" id="workouts" role="tabpanel" aria-labelledby="workouts-tab">
            <h3>Your Workouts</h3>
            <table class="table table-striped">
              <thead>
              <tr>
                <th>Date</th>
                <th>Notes</th>
                <th>Exercises</th>
                <th>Actions</th>
              </tr>
              </thead>
              <tbody>
              <tr th:each="workout : ${workouts}">
                <td th:text="${#temporals.format(workout.workoutDate, 'yyyy-MM-dd HH:mm')}"></td>
                <td th:text="${workout.notes} ?: 'No notes'"></td>
                <td>
                                <span th:each="exercise, iterStat : ${workout.workoutExercises}"
                                      th:text="${exercise.exerciseType == 'cardio' ? exercise.cardioExerciseName : exercise.weightExerciseName} + (${iterStat.last} ? '' : ', ')"></span>
                  <span th:if="${workout.workoutExercises.isEmpty()}">No exercises</span>
                </td>
                <td>
                  <a th:href="@{/workouts/viewWorkout/{id}(id=${workout.workoutId})}" class="btn btn-sm btn-info">View</a>
                  <a th:href="@{/workouts/delete/{id}(id=${workout.workoutId})}" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure?')">Delete</a>
                </td>
              </tr>
              <tr th:if="${workouts.isEmpty()}">
                <td colspan="4">No workouts found.</td>
              </tr>
              </tbody>
            </table>

            <!-- Workout Pagination -->
            <nav aria-label="Workout pagination">
              <ul class="pagination">
                <li class="page-item" th:classappend="${currentWorkoutPage == 1} ? 'disabled'">
                  <a class="page-link" th:href="@{/users/list/{userId}(userId=${userId}, workoutPage=${currentWorkoutPage - 1}, mealPage=${currentMealPage})}">Previous</a>
                </li>
                <li class="page-item" th:each="i : ${#numbers.sequence(1, totalWorkoutPages)}"
                    th:classappend="${i == currentWorkoutPage} ? 'active'">
                  <a class="page-link" th:href="@{/users/list/{userId}(userId=${userId}, workoutPage=${i}, mealPage=${currentMealPage})}" th:text="${i}"></a>
                </li>
                <li class="page-item" th:classappend="${currentWorkoutPage == totalWorkoutPages} ? 'disabled'">
                  <a class="page-link" th:href="@{/users/list/{userId}(userId=${userId}, workoutPage=${currentWorkoutPage + 1}, mealPage=${currentMealPage})}">Next</a>
                </li>
              </ul>
            </nav>
          </div>

          <!-- Meals Tab -->
          <div class="tab-pane fade" id="meals" role="tabpanel" aria-labelledby="meals-tab">
            <h3>Your Meals</h3>
            <table class="table table-striped">
              <thead>
              <tr>
                <th>Date</th>
                <th>Notes</th>
                <th>Foods</th>
              </tr>
              </thead>
              <tbody>
              <tr th:each="meal : ${meals}">
                <td th:text="${#temporals.format(meal.mealDate, 'yyyy-MM-dd HH:mm')}"></td>
                <td th:text="${meal.mealNotes} ?: 'No notes'"></td>
                <td>
                                <span th:each="food, iterStat : ${meal.mealFoods}"
                                      th:text="${food.mealFoodName} + (${iterStat.last} ? '' : ', ')"></span>
                  <span th:if="${meal.mealFoods.isEmpty()}">No foods</span>
                </td>
              </tr>
              <tr th:if="${meals.isEmpty()}">
                <td colspan="3">No meals found.</td>
              </tr>
              </tbody>
            </table>

            <!-- Meal Pagination -->
            <nav aria-label="Meal pagination">
              <ul class="pagination">
                <li class="page-item" th:classappend="${currentMealPage == 1} ? 'disabled'">
                  <a class="page-link" th:href="@{/users/list/{userId}(userId=${userId}, workoutPage=${currentWorkoutPage}, mealPage=${currentMealPage - 1})}">Previous</a>
                </li>
                <li class="page-item" th:each="i : ${#numbers.sequence(1, totalMealPages)}"
                    th:classappend="${i == currentMealPage} ? 'active'">
                  <a class="page-link" th:href="@{/users/list/{userId}(userId=${userId}, workoutPage=${currentWorkoutPage}, mealPage=${i})}" th:text="${i}"></a>
                </li>
                <li class="page-item" th:classappend="${currentMealPage == totalMealPages} ? 'disabled'">
                  <a class="page-link" th:href="@{/users/list/{userId}(userId=${userId}, workoutPage=${currentWorkoutPage}, mealPage=${currentMealPage + 1})}">Next</a>
                </li>
              </ul>
            </nav>
          </div>
        </div>

        <!-- Posts Tab -->
        <div class="tab-pane fade" id="posts" role="tabpanel" aria-labelledby="posts-tab">
          <h3>Your Posts</h3>
          <table class="table table-striped">
            <thead>
            <tr>
              <th>Date</th>
              <th>Message</th>
              <th>Replies</th>
              <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="post : ${posts}">
              <td th:text="${#temporals.format(post.postDate, 'yyyy-MM-dd HH:mm')}"></td>
              <td th:text="${post.postMessage} ?: 'No message'"></td>
              <td>
                <span th:if="${post.replies.isEmpty()}">No replies</span>
                <span th:unless="${post.replies.isEmpty()}" th:text="${#lists.size(post.replies)} + ' replies'"></span>
              </td>
              <td>
                <a th:href="@{/posts/show-post/{id}(id=${post.postId})}" class="btn btn-sm btn-info">View</a>
                <a th:href="@{/posts/delete/{id}(id=${post.postId})}" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure?')">Delete</a>
              </td>
            </tr>
            <tr th:if="${posts.isEmpty()}">
              <td colspan="4">No posts found.</td>
            </tr>
            </tbody>
          </table>

          <!-- Post Pagination -->
          <nav aria-label="Post pagination">
            <ul class="pagination">
              <li class="page-item" th:classappend="${currentPostPage == 1} ? 'disabled'">
                <a class="page-link" th:href="@{/users/list/{userId}(userId=${userId}, workoutPage=${currentWorkoutPage}, mealPage=${currentMealPage}, postPage=${currentPostPage - 1})}">Previous</a>
              </li>
              <li class="page-item" th:each="i : ${#numbers.sequence(1, totalPostPages)}"
                  th:classappend="${i == currentPostPage} ? 'active'">
                <a class="page-link" th:href="@{/users/list/{userId}(userId=${userId}, workoutPage=${currentWorkoutPage}, mealPage=${currentMealPage}, postPage=${i})}" th:text="${i}"></a>
              </li>
              <li class="page-item" th:classappend="${currentPostPage == totalPostPages} ? 'disabled'">
                <a class="page-link" th:href="@{/users/list/{userId}(userId=${userId}, workoutPage=${currentWorkoutPage}, mealPage=${currentMealPage}, postPage=${currentPostPage + 1})}">Next</a>
              </li>
            </ul>
          </nav>
        </div>
      </div>

        <!-- Links to add new workout/meal -->
        <a th:href="@{/workouts/addWorkout/{userId}(userId=${userId})}" class="btn btn-primary mt-3">Add Workout</a>
        <a th:href="@{/meals/addMeal/{userId}(userId=${userId})}" class="btn btn-primary mt-3">Add Meal</a>
        <a th:href="@{/posts/addPost/{userId}(userId=${userId})}" class="btn btn-primary mt-3">Add Post</a>


      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

      <!-- Workout Form -->

    </main>

    <!-- Right Sidebar -->
    <aside class="col-md-3 col-12 p-3 right-sidebar d-none d-md-block">
      <!--
      <div class="challenge">
        <h3>Current Challenge</h3>
        <p>Complete 5 workouts this week!</p>
        <div class="progress">
          <div class="progress-bar progress-bar-custom" style="width: 60%;" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
        <p class="mt-2">3/5 Workouts done</p>
      </div>-->
      <div class="tribe">
        <h3><span th:text="${userName}"></span> Tribe</h3>
        <!--
        <ul class="list-unstyled">
          <li>Jane Doe</li>
          <li>John Smith</li>
          <li>Sarah Wilson</li>
          <li>Alex Lee</li>
        </ul>-->

        <div th:each="friend : ${friends}" >
          <a th:href="@{/users/dashboard2/{id}(id=${friend.userId})}" th:text="${friend.userName}">Friend Username</a>
        </div>
        <div th:if="${#lists.isEmpty(friends)}" >
          <p class="mb-0">No friends found.</p>
        </div>
      </div>
    </aside>

  </div>
</div>
<!-- Bootstrap JS and Popper.js -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous"></script>

</body>
</html>
